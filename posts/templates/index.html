{% extends 'base.html' %}

{% block script %}
    <script>
        function submitForm(id) {
            document.getElementById(id).submit();
        }
    </script>
{% endblock %}

{% block content %}
    <div class="container">
        <form action="/" method="POST" name="blogpost">
            {% csrf_token %}
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Title" name="title" aria-describedby="basic-addon1">
            </div>

            <div class="form-group">
                <textarea class="form-control text-field" rows="5" id="comment" name="text" placeholder="Enter your message here"></textarea>
            </div>
            <input type="submit" class="btn btn-info" value="Submit">
        </form>
        {% for post in posts_list %}
            {% if forloop.first %}<div class="row">{% endif %}
            <div class="col-md-10 blogpost">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">{{ post.title }}</h3>
                        <span data-title="Delete" class="delete-btn glyphicon glyphicon-trash" onclick="submitForm({{ post.pk }})"></span>
                    </div>

                    <form action="/delete-post/{{ post.id }}/" method="post" id="{{ post.pk }}">
                        {% csrf_token %}
                    </form>
                    <div class="panel-body">
                        {{ post.text }}<small>{{ post.date }}</small>
                    </div>
                </div>
            </div>
            {% if forloop.counter|divisibleby:1 %}</div><div class="row">{% endif %}
            {% if forloop.last %}</div>{% endif %}
        {% endfor %}
    </div>
{% endblock %}
